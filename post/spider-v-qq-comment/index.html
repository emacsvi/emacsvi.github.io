<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta name="generator" content="Hugo 0.54.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>python爬腾讯视频评论信息 | 李伟的博客</title>
    <meta property="og:title" content="python爬腾讯视频评论信息 - 李伟的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content="2018-11-23T01:00:39&#43;08:00">
        
        
    <meta property="article:modified_time" content="2018-11-23T01:00:39&#43;08:00">
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,区块链,博客,项目管理,python,软件架构">
    <meta name="description" content="python爬腾讯视频评论信息">
        
    <meta name="author" content="emacsvi">
    <meta property="og:url" content="http://emacsvi.com/post/spider-v-qq-comment/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href="/css/normalize.css">
    
        <link rel="stylesheet" href="/css/prism.css">
    
    <link rel="stylesheet" href="/css/style.css">
    <script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129687838-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-129687838-1');
    </script>


    


    
    
</head>

<body>
<header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="http://emacsvi.com">
                        李伟的博客
                    </a>
                
                <p class="description">主要专注于区块链、Go语言(golang)、Python、C语言、后端服务架构</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="http://emacsvi.com">首页</a>
                    
                    <a  href="http://emacsvi.com/archives/" title="归档">归档</a>
                    
                    <a  href="http://emacsvi.com/about/" title="关于">关于</a>
                    
                    <a  href="http://emacsvi.com/travel/" title="旅行">旅行</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>


<div id="body">
    <div class="container">
        <div class="col-group">

            <div class="col-8" id="main">
                <div class="res-cons">
                    <article class="post">
                        <header>
                            <h1 class="post-title">python爬腾讯视频评论信息</h1>
                        </header>
                        <date class="post-meta meta-date">
                            2018年11月23日
                        </date>
                        
                        <div class="post-meta">
                            <span>|</span>
                            
                                <span class="meta-category"><a href="http://emacsvi.com/categories/python">python</a></span>
                            
                        </div>
                        
                        
                        <div class="post-content">
                            

<h1 id="介绍">介绍</h1>

<p>爬取腾讯某个视频下面的评论数。主要内容是涉及到列表不容易获取。</p>

<h1 id="分析">分析</h1>

<p>分析腾讯视频评论：
视频链接是这个：<a href="https://v.qq.com/x/cover/v0v3l4jwkznj6ja.html">https://v.qq.com/x/cover/v0v3l4jwkznj6ja.html</a></p>

<pre><code class="language-text">评论的链接通过抓包可以找到：
评论列表1：
https://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6193732310337484120&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9&amp;=1543067756415

评论列表2：
https://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6401735222082648902&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9&amp;=1543067756416

评论列表3：
https://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6187992457353447288&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9&amp;=1543067756417

看出来应该是cursor字段有规律的。但是他们是什么规律呢，应该是迭代的规则，搜索一下cursor=6187992457353447288这里面的数字内容：
发现在上一个请求的response内容里面有这样的内容：
first&quot;:&quot;6401773095062700861&quot;,&quot;last&quot;:&quot;6187992457353447288&quot;,
意思是上一次请求会返回下一次请求的id号。于是这样我们就知道了。

另外最后那个变的数字有没有用，我们删除再去请求测试发现可有可无的。

提取数据：利用&quot;content&quot;:&quot;内容&quot;来提取即可。
</code></pre>

<h1 id="实现">实现</h1>

<p>这里要注意如果用https的时候会报错，那改为http一样也可以的。</p>

<pre><code class="language-python">import urllib.request
import re
vid=&quot;1484725385&quot;
cid=&quot;6193732310337484120&quot;

for i in range(0, 5):
    print(&quot;正在输出第&quot;+str(i+1)+&quot;页评论&quot;)
    url=&quot;http://video.coral.qq.com/varticle/&quot;+str(vid)+&quot;/comment/v2?callback=varticle&quot;+str(vid)+&quot;commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=&quot;+str(cid)+&quot;&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9&quot;
    print(url)
    data=urllib.request.urlopen(url).read().decode(&quot;utf-8&quot;, &quot;ignore&quot;)
    pat='&quot;content&quot;:&quot;(.*?)&quot;'
    allcomment=re.compile(pat, re.S).findall(data)
    pat_cid='&quot;last&quot;:&quot;(.*?)&quot;'
    cid=re.compile(pat_cid, re.S).findall(data)[0]
    for comment in allcomment:
        print(eval(&quot;u'&quot;+str(comment)+&quot;'&quot;))
</code></pre>

<p>结果：</p>

<pre><code class="language-text"> python3 v_qq_commemt.py
正在输出第1页评论
http://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6193732310337484120&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9
尼玛比为了看个新白娘子传奇，劳资还特地开个VIP，多久前的老片儿了还弄个VIP，都是小戏骨白蛇传的坑啊，我还真往这坑里跳，开都开了回顾一下经典吧，有人在看吗？
看了王牌对王牌之后又来看这个的 请举手
好感人呀。雅芝姐姐演技爆棚，看的我是肝肠寸断。要是我身边有这样美且惠的人，是蛇精我也认了
扮演许仙的演员在中国乃至世界上是不是真的再也找不到了，非要让个女的来演，两个女人爱得死去活来，不别扭吗？
又来看一遍，，心里面伤感，怀念，童年岁月，纯真，美好的回忆。92年的我越来越爱经典了。怎么办？是不是老了。。。。千年等一回，，，啊啊啊我无悔啊啊啊，，，
想来回顾经典，结果点开就是VIP...？？？？
张玉堂看起来很轻挑的样子，我喜欢仕林这样的
我想说下面的看得起就看，看不起就不要出来丢人了，怕人家知道你穷吗？
六小龄童演活了孙悟空 叶童演活了许仙 张国立演活了皇帝 陈道明演活了康熙 赵雅芝演活了白素贞 演绝了冯程程 李若彤演活了小龙女 翁美玲演活了黄蓉 这些都是经典之作 无论如何翻拍 也没有原版经典
观音菩萨说他们只有三天情缘，三天之后，一成佛来一成仙，不能动情，不能相爱……小时候看新白以为结局完美，现在看来是悲剧
正在输出第2页评论
http://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6401735222082648902&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9
这集29集眼泪止不住，虽然看过很多遍了
经典经典，没有可以超越的。
2018.3.29再来看一遍。我最喜欢的演员们！
许仙送素贞雨伞 最后他们俩个确实分开了一段时间 我想知道赵雅芝有没有和叶童一起看过这部剧 太完美了 经典 赵雅芝的新白娘子传奇 六小龄童的西游记 黄日华的射雕英雄传 李若彤的神雕侠侣 赵薇的情深深雨蒙蒙 最美的鬼故事聊斋 张国立的康熙微服私访记 和铁齿铜牙纪晓岚 陈道明的康熙王朝 小李琳的上错花轿嫁对郎 我永远忘不了 杜冰雁揭开红盖头的那一刻 还有大结局 杜冰雁和袁不屈相见的时刻 简直就是仙女下凡 总之这些都是经典 无论如何翻拍 也无法超越
我是看了小戏骨，才反过来看这个经典的，你们有木有人和我一样[呲牙][呲牙][呲牙]
看了那么多年，终于等到里边唱的歌也有字幕了，原来都只是台词有字幕，唱的那些好多词都听不清楚
嘿嘿每次看这一段都笑喷
90后爱新白娘子传奇
这死法海，一个坏妖怪也不收，哼
92年赵雅芝就有38岁
真是无耻，新上映的收费还能理解，多少年前的老经典，还收费，太恶心了，利欲熏心
正在输出第3页评论
http://video.coral.qq.com/varticle/1484725385/comment/v2?callback=varticle1484725385commentv2&amp;orinum=10&amp;oriorder=o&amp;pageflag=1&amp;cursor=6187992457353447288&amp;scorecursor=0&amp;orirepnum=2&amp;reporder=o&amp;reppageflag=1&amp;source=9
拍戏是很认真的，这么小的宝宝 。是真宝宝
这才是正确的打开白娘子方式~看了杨紫的傻白千年蛇妖白夭夭虐恋后，回来看老版来慰藉心灵的~说什么不是白素贞许仙，但除了许宣和白夭夭名字外，法海，小青，姐姐许娇容，捕头姐夫李公甫都存在~尴尬了。。。
这是我看的第五十次，真的不怎么好看
慈航真人普度众生皆苦
看看人家以前的特技效果，再看看现在的电视都是五毛钱特效，这些拿观众当傻子的所谓电视人也不会惭愧吗？科技在进步，特效反而退步了？有些电视甚至所有景都抠图完成，真TM可耻
有木有追完流星花园来看这个的
论演技，是真的演得很好，都不知道评论里怎么那么较真
怀念过去，老了！以前放寒暑假电视台总放，满满的回忆啊！
</code></pre>

                        </div>

                        


                        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/post/spider-sogou-weixin/">用户代理与ip代理爬取搜狗微信文章</a></li>
        
        <li><a href="/post/spider-crawler-python/">python爬虫常用接口备忘</a></li>
        
        <li><a href="/post/mygatsbyjs-blog/">gatsbyJs博客</a></li>
        
        <li><a href="/post/ethereum-decode-input-data/">解码以太坊input数据</a></li>
        
        <li><a href="/post/linux-screen/">linux-screen后台会话</a></li>
        
    </ul>
</div>


                        <div class="post-meta meta-tags">
                            
                            <ul class="clearfix">
                                
                                <li><a href="http://emacsvi.com/tags/python">python</a></li>
                                
                                <li><a href="http://emacsvi.com/tags/%E7%88%AC%E8%99%AB">爬虫</a></li>
                                
                            </ul>
                            
                        </div>
                    </article>
                    
    

    
    
                </div>
            </div>
            <div id="secondary">
    <section class="widget">
        <form id="search" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="http://emacsvi.com">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="http://emacsvi.com/post/kubeadm-kubernetes/" title="利用kubeadm部署kubernetes">利用kubeadm部署kubernetes</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/centos7-system-notes/" title="centos7系统配置">centos7系统配置</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/vagrant-notes/" title="vagrant相关配置命令">vagrant相关配置命令</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/heling-go-36-notes/" title="赫林老师go语言36讲">赫林老师go语言36讲</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/frp/" title="frp内网穿透">frp内网穿透</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/harbor-image-notes/" title="harbor镜像仓库搭建">harbor镜像仓库搭建</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/dynamic-json-in-go/" title="Dynamic Json In Go">Dynamic Json In Go</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/my-go-codes/" title="go常用的一些代码备忘">go常用的一些代码备忘</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/go-keng-notes/" title="go语言编码过程中常见的坑总结">go语言编码过程中常见的坑总结</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/post/go-websocket-practice/" title="websocket实践">websocket实践</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">分类</h3>
<ul class="widget-list">
    
    <li>
        <a href="http://emacsvi.com/categories/blockchain/">blockchain(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/consul/">consul(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/db/">db(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/docker/">docker(2)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/etcd/">etcd(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/ethereum/">ethereum(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/go/">go(30)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/kubernetes/">kubernetes(2)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/linux/">linux(4)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/mac/">mac(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/markdown/">markdown(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/nodejs/">nodejs(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/python/">python(10)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/react/">react(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/redis/">redis(2)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/%E6%8A%80%E6%9C%AF/">技术(1)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/%E6%97%85%E8%A1%8C/">旅行(4)</a>
    </li>
    
    <li>
        <a href="http://emacsvi.com/categories/%E6%B5%81%E9%87%91%E5%B2%81%E6%9C%88/">流金岁月(1)</a>
    </li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">标签</h3>
<div class="tagcloud">
    
    <a href="http://emacsvi.com/tags/Istio/">Istio</a>
    
    <a href="http://emacsvi.com/tags/blockchain/">blockchain</a>
    
    <a href="http://emacsvi.com/tags/cmds/">cmds</a>
    
    <a href="http://emacsvi.com/tags/codis/">codis</a>
    
    <a href="http://emacsvi.com/tags/consul/">consul</a>
    
    <a href="http://emacsvi.com/tags/curl/">curl</a>
    
    <a href="http://emacsvi.com/tags/db/">db</a>
    
    <a href="http://emacsvi.com/tags/django/">django</a>
    
    <a href="http://emacsvi.com/tags/docker/">docker</a>
    
    <a href="http://emacsvi.com/tags/docker-compose/">docker-compose</a>
    
    <a href="http://emacsvi.com/tags/etcd/">etcd</a>
    
    <a href="http://emacsvi.com/tags/ethereum/">ethereum</a>
    
    <a href="http://emacsvi.com/tags/go/">go</a>
    
    <a href="http://emacsvi.com/tags/javascript/">javascript</a>
    
    <a href="http://emacsvi.com/tags/kubernetes/">kubernetes</a>
    
    <a href="http://emacsvi.com/tags/linux/">linux</a>
    
    <a href="http://emacsvi.com/tags/mac/">mac</a>
    
    <a href="http://emacsvi.com/tags/markdown/">markdown</a>
    
    <a href="http://emacsvi.com/tags/mongodb/">mongodb</a>
    
    <a href="http://emacsvi.com/tags/mysql/">mysql</a>
    
    <a href="http://emacsvi.com/tags/nodejs/">nodejs</a>
    
    <a href="http://emacsvi.com/tags/python/">python</a>
    
    <a href="http://emacsvi.com/tags/react/">react</a>
    
    <a href="http://emacsvi.com/tags/redis/">redis</a>
    
    <a href="http://emacsvi.com/tags/selenium/">selenium</a>
    
    <a href="http://emacsvi.com/tags/sql/">sql</a>
    
    <a href="http://emacsvi.com/tags/supervisord/">supervisord</a>
    
    <a href="http://emacsvi.com/tags/vagrant/">vagrant</a>
    
    <a href="http://emacsvi.com/tags/websocket/">websocket</a>
    
    <a href="http://emacsvi.com/tags/%E5%A4%87%E5%BF%98/">备忘</a>
    
    <a href="http://emacsvi.com/tags/%E6%8A%80%E6%9C%AF/">技术</a>
    
    <a href="http://emacsvi.com/tags/%E6%97%85%E8%A1%8C/">旅行</a>
    
    <a href="http://emacsvi.com/tags/%E7%88%AC%E8%99%AB/">爬虫</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="#" title="Android Gradle权威指南">Android Gradle权威指南</a>
        </li>
        
        <li>
            <a target="_blank" href="#" title="常用开发工具CDN镜像">常用开发工具CDN镜像</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="http://emacsvi.com/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
        </div>
    </div>
</div>
<footer id="footer">
    <div class="container">
        &copy; 2019 <a href="http://emacsvi.com">李伟的博客 By emacsvi</a>.
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        <a href="https://www.emacsvi.com/" target="_blank">Theme</a> based on <a href="https://emacsvi.com" target="_blank">maupassant</a>.
        
    </div>
</footer>


    <script type="text/javascript">
    
    (function(){
        $("pre code").parent().addClass("line-numbers")
    }())

    window.MathJax = {
        tex2jax: {
            inlineMath: [ ['$','$'] ],
            processEscapes: true
        }
    };
    </script>
    <script type="text/javascript" src="/js/prism.js" async="true"></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src="/js/totop.js?v=0.0.0" async=""></script>







</body>
</html>
